
정보(data) + 창고(warehouse)가 결합한 의미로
의사결정에 도움을 주기 위해 
분석가능한 형태로 변환한 데이터들이 저장되어 있는 중앙 저장소



https://pearlluck.tistory.com/275


DB  = 
DW = 데이터를 분석하기 좋은 구조로 설계한다.

**대표적인 구조 :**

- 스타(star) 스키마, - star schema 
- 스노우 플레이크(snowflake) 스키마 - 눈송이 schema 


### 1. 스타 스키마 (Star Schema) 

- 중앙 Fact 테이블: 하나의 중심 테이블에 측정값 저장
- 주변 Dimension 테이블: 차원 정보를 담은 테이블들이 Fact 테이블 주변에 위치
- 1:N 관계: 각 Dimension은 Fact 테이블과 1:N 관계
- 정규화 사용

장점:

- 단순한 조인 구조 (Fact ↔ Dimension)
- 쿼리 작성이 쉽고 직관적
- 인덱스 설계가 단순함
- 성능 예측이 용이

단점:

- 데이터 중복 발생 (Denormalization)
- 저장 공간 증가

### 2. 스노우플레이크 스키마 (Snowflake Schema)

- 정규화된 Dimension: Dimension 테이블들이 다시 정규화됨
- 계층적 구조: Dimension 내부에 하위 Dimension 존재
- 복잡한 조인: 여러 단계의 조인이 필요
- 정규화 사용하지 않음

장점:

- 저장 공간 효율적
- 데이터 중복 최소화
- 정규화된 구조

단점:

- 복잡한 조인: 3-4단계 조인 필요
- 쿼리 복잡성: SQL 작성이 어려움
- 성능 예측 어려움: 조인 경로에 따른 성능 변동
- 유지보수 어려움: 스키마 변경 시 영향 범위 광범위

### 3. 스타 스키마 vs 스노우플레이크 스키마 비교

| 구분     | 스타 스키마      | 스노우플레이크 스키마    |
| ------ | ----------- | -------------- |
| 조인 복잡도 | 단순 (1단계)    | 복잡 (다단계)       |
| 쿼리 성능  | 빠름          | 상대적으로 느림       |
| 저장 공간  | 많이 사용       | 효율적            |
| 유지보수   | 쉬움          | 어려움            |
| 확장성    | 좋음          | 제한적            |
| 적합     | 데이터마트       | 데이터 웨어하우스      |
| 장,단    | 무결성, 중복 데이터 | 조인으로 인한 쿼리 복잡성 |

"정규화 구조에서 집계 쿼리 성능 저하의 근본 원인은:

1. 복잡한 조인: 6개 테이블 조인으로 인한 성능 저하
2. 전체 테이블 스캔: 인덱스 효율성 저하로 인한 전체 데이터 스캔
3. 인덱스 설계 한계: 복잡한 조인으로 인한 복합 인덱스 설계 어려움

스타 스키마 도입으로 해결한 방법:
1. 단순한 조인 구조: Fact-Dimension 1단계 조인
2. 파티셔닝 활용: 시간별 파티셔닝으로 스캔 범위 제한
3. 최적화된 인덱스: 복합 인덱스로 조회 성능 극대화


스타 스키마 도입으로 해결한 방법:
1. 단순한 조인 구조: Fact-Dimension 1단계 조인
2. 파티셔닝 활용: 시간별 파티셔닝으로 스캔 범위 제한
3. 최적화된 인덱스: 복합 인덱스로 조회 성능 극대화
4. 

- 복잡한 조인으로 인해 복합 인덱스 설계 어려움
- 각 테이블별로 개별 인덱스만 가능

- 파티셔닝: 시간별 파티셔닝으로 스캔 범위 제한
- 복합 인덱스: (createdTime, projectId, organizationId) 순서로 설계
- 커버링 인덱스: 자주 조회되는 컬럼들을 인덱스에 포함

---

VM (마스터 테이블) ← 여전히 존재
├── fact_vm_metric_day
├── fact_sddc_vm_dimensions (Dimension 관계 테이블)
│   ├── dimension_sddc_vm
│   ├── dimension_project
│   ├── dimension_organization
│   └── dimension_zone