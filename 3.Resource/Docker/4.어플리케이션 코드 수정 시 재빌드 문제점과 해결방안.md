
어플리케이션을 만들다 보면 소스코드가 변경되어
그에 따라 변경된 부분을 확인하면서 갭라해 나가야한다. (도커의 실시간 반영을 확인)


[Note](obsidian👨‍⚕️


1. 도커 파일 작성
2. 도커 파일로 이미지 생성
3. 도커 이미지로 컨테이너 생성 후 실행
   
	
소스코드를 계속 변경시켜 어플리케이션에 반영시키려면 해당 구간 전체를 다시 실행줘야한다. (이미지 실행부터)
실제로 이러한 방법으로 build, run을 계속하게 된다면 매우 불편한데..

소스코드가 변하게되면  COPY ./ ./ 으로 인해서 소스를 변하시킨 부분은 server.js 뿐인데 모든 node_module에 있는 종속성들까지 다시 다운받아주어야 한다.
()



---

## 해결방안

FROM n:10    

WORKDIR /usr/src/app

COPY ./ ./

RUN npm install 

CMD ["node", "server.js"]

현재 문제점은 server.js 내부의 소스만 변경하였는데  
npm install 로 종속성을 다시 다운받는다는 점이 문제였다.

-> 해당 내역을 
 
COPY package.json ./ -> 종속성 부분만 미리 다운받아서 
RUN npm install  -> npm install로 실행하도록 설정한다. package.json이 변경된게 아니기때문에 종속성을 다시 다운받지 않는다.
COPY ./ ./ 

기존에는 전체를 복사하여 확인하기 때문에 npm install 시 작은 변화라도 다시 종속성을 다운 받았다.
하지만  package.json으로 copy를 제한하면서 cache를 이용하여 두 번 다운받는 것을 생략하였다.

이제는 npm install 전에 package.json만 따로 변경해줘서 쓸데없는 모듈을 다운받지 않아도 되게 되었습니다.

하지만 아직도 소스를 변경할때마다 변경된 소스 부분은 COPY 한 후 이미지를 다시 빌드를 해주고 컨테이너를 다시 실행해줘야지 변경된 소스가 화면에 반영이 됩니다.

이러한 작업은 시간소요가 크며 이미지도 너무 많이 빌드하게 됩니다.
이러한 문제점을 해결하기 위해서 Volumne을 사용하게 된다.
