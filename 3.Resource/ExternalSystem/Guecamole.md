### 도입 배경


### 나의 상황 

- VPC(Virtual Public Cloud)에 분산된 VM에 사용자들이 원격으로 접근하고자 하는 요구사항 이 발생하여 도입 
- 각 VM은 **Transit Segment** 같은 내부망에만 붙어 있어서 외부에서 직접 접근할 수 없음.
- VM마다 SSH/RDP 접속이 필요하지만, 사용자가 직접 내부망 구조나 IP를 알게 하고 싶지 않음. 
- 포털(관리 서버)이 대신 Guacamole 서버랑 연동해서 사용자가 **웹 브라우저만으로 콘솔(터미널/데스크탑)**을 띄울 수 있게 하고 싶음.
- VM마다 포트포워딩이 되어 있더라도, 이걸 사용자가 직접 연결하지 않고 **중앙 게이트웨이로 통합 관리**하고 싶음.
- 따라서 **사용자 쪽에 별도 클라이언트 설치 필요 없이, 보안 제어된 게이트웨이로 내부망을 안전하게 오픈**하는 역할로 Guacamole이 필요함.

---

### 도입 이유

**왜 Guacamole을 도입했는가?**

- 우리 인프라는 여러 VPC에 VM과 클러스터가 분산되어 있고, 이 VM들은 Transit Segment(내부망)으로만 연결된다.
- 일반 사용자에게는 직접 내부망 접근 권한을 주지 않고, 포털에서 인증과 연결을 대신 관리해야 한다.
- VM에 접근하기 위해 SSH, RDP 등 다양한 원격 접속 방식이 필요하지만, 사용자 환경에 클라이언트 프로그램을 설치하게 하고 싶지 않았다.
- Guacamole을 도입해 웹 브라우저만으로 터미널/데스크탑에 접속할 수 있게 하고, 외부에서 직접 내부망을 노출하지 않고도 포털을 통해 안전하게 접근할 수 있도록 했다.
- 이를 통해 포트포워딩과 NAT 설정을 중앙 집중적으로 관리하고, 접근 권한과 세션을 포털에서 제어하며 보안성을 유지할 수 있다.

---

```scss
 ┌────────────┐       ┌───────────────┐       ┌────────────┐
 │   Portal   │ <---> │  Guacamole     │ <---> │    VM      │
 │ (Admin UI) │       │ (Terminal Proxy) │     │ (Linux etc)│
 └────────────┘       └───────────────┘       └────────────┘
         │
   (Same Subnet / Same VPC)

```

- **포탈**은 Guacamole에 API 호출만 함 (토큰 생성, 세션 관리)
- **Guacamole 서버**는 VM으로 SSH 연결 Proxy 역할.
- **VM**은 Private IP만 가지고 있음 (Public IP 불필요).
- 이 3개가 같은 서브넷(VLAN, Subnet, VPC 세그먼트 등) 안에 있으면,
    - Guacamole → VM 으로 **내부망 SSH** 가능.
    - 방화벽만 열려 있으면 됨.
- 외부에서 접근은 포탈(또는 Guacamole)에만 HTTPS로.
---


## ✅ 이런 식이면 좋은 점 (장점)

- **Public IP 할당 비용 없음** → 대량 VM 운영 시 비용↓
- SSH 직접 노출 안됨 → 보안↑
- Bastion 따로 두는 것보다 구조 단순 (Guacamole 자체가 Bastion 역할)