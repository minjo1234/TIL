
스프링 컨테이너는 싱글톤 패턴의 문제점을 해결하면서, 객체 인스턴스를 싱글톤으로 관리한다.

#### [[3.Resource/Spring/Spring 개요/싱글톤 컨테이너.md|싱글톤 컨테이너]]

- 스프링 컨테이너는 싱글톤 패턴을 적용하지 않아도, 객체 인스턴스를 싱글톤으로 관리한다.
- 스프링 컨테이너는 싱글톤 컨테이너의 역할을 한다.  객체를 싱글톤으로 유지할 수 있다.
  
  - 싱글톤 패턴을 위한 지저분한 코드가 들어가지 않아도 된다.
  - DIP, OCP, priavte 생성자로부터 자유롭게 싱글톤을 생성할 수 있다.
    
스프링의 기본 빈 등록 방식은 싱글톤이지만, 싱글톤 방식 뿐만 아니라 요청할 때 마다 새로운 객체를 생성하여 반환하는 것도 가능하다.


---

#### 싱글톤 방식의 주의점

싱글톤 방식은 하나의 인스턴스를 공유하기 떄문에 상태를 유지하게 설계하면 안된다. 무상태(stateless)하게 설계해야 한다.

- 특정 클라이언트에 의존적인 필드가 있으면 안된다.
- 특정 클라이언트가 값을 변경할 수 있는 코드가 있으면 안되다.
- 가급적 읽기가 가능해야 한다.
- 필드 대신에 자바에서 공유되지않는 지역변수, 파라미터, ThreadLocal 등을 사용해야 한다.

```
// @Bean  memberService -> new MemoryMemberRepository()  
// @Bean  orderService -> new MemoryMemberRepository() , new RateDiscountPolicy()

이러면 싱글톤 깨지는거 아님??

```

스프링은 어떠한 방식으로라도 싱글톤을 보장해준다.

[[Configuration과 바이트코드 조작의 마법]]

